<!DOCTYPE html>
<html>
    <head>
        <script src="/libraries/jQuery.js"></script>
        <script src="/libraries/Ace/build/ace.js"></script>
        <script src="/console.js"></script>
        <link rel="stylesheet" href="/console.css" type="text/css" />
        
        <style>
            html, body{
                width: 100%;
                height: 100%;
                margin: 0px;
            }
            body>div{
                width: 100%;
                max-width: 800px;
                margin-left: auto;
                margin-right: auto;
            }
            .console{
                height: calc(100% - 25px);
                border: 1px solid #CCC;
                width: calc(100% - 2px);
            }
        </style>
        <script>
            function updateURLText(url){
                var req = new XMLHttpRequest();
                req.open("GET", "https://cors-anywhere.herokuapp.com/"+url, false);
                req.send();
                window.randomText = req.response;
            }
            
            function copyToClipBoard(text){
                var inp = document.createElement('textarea');
                document.body.appendChild(inp)
                inp.value = text;
                inp.select();
                document.execCommand('copy', false);
                inp.remove();
            }
            
            $(function(){
                updateURLText(document.getElementById("WebsiteURL").value);
                
                var cons = $(".console").console({
                    mode: "r",
                    onInput: function(text){
                        try{
                            var m = text.match(/\/(.*)\/(.*)/);
                            var regex;
                            if(m) regex = new RegExp(m[1], m[2]);
                            else regex = new RegExp(text, "g");
                            
                            var match;
                            var out = [];
                            for(var i=0; i<100 && (match = regex.exec(window.randomText)); i++)
                                out.push(match);
                                
                            this.output(out);
                        }catch(e){
                            this.error(e);
                        }
                    },
                    onRightClick: function(obj){
                        var out = "[";
                        if(typeof(obj.data)=="string") out = obj.data;
                        else if(typeof(obj.data[0])=="string") out = obj.data[0];
                        else{
                            for(var i=0; i<obj.data.length; i++)
                                if(typeof(obj.data[i][0])=="string") 
                                    out += obj.data[i][0]+",";
                            out = out.substring(0, out.length-1) + "]";
                        }
                        
                        copyToClipBoard(out);
                        this.info("The following has be copied to your clipboard:\n"+out);
                    }
                });
            });
        </script>
    </head>
    <body>
        <div>
            <span>Select site: </span>
            <input type=field id="WebsiteURL" size=50 value="https://content.nunction.net/humor/alice-and-bob.txt" />
        </div>
        <div class="console"></div>
    </body>
</html>